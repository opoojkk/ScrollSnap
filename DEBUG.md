# ScrollSnap 调试指南

## 检查扩展是否正确加载

### 1. 检查扩展状态

1. 打开 `chrome://extensions/`
2. 确保 **ScrollSnap** 扩展已启用
3. 检查是否有错误提示（红色感叹号）

### 2. 查看 Content Script 日志

1. 打开任意网页（如 https://example.com）
2. 按 **F12** 打开开发者工具
3. 切换到 **Console** 标签
4. 查找消息：`✓ ScrollSnap content script loaded and ready`
5. 如果看不到这条消息，刷新页面

### 3. 测试选择区域功能

#### 步骤：

1. **点击扩展图标** - 应该出现弹出窗口
2. **点击"选择区域"按钮**
   - 应该看到状态提示："正在启动选择模式..."
   - 然后："✓ 已进入选择模式，请在页面上拖动鼠标"
   - 窗口会在0.8秒后自动关闭

3. **在页面上观察**：
   - 整个页面应该有半透明的深色遮罩
   - 顶部中央应该出现提示："📌 拖动鼠标选择要截图的区域"
   - 鼠标指针应该变成十字形

4. **拖动鼠标**：
   - 按住鼠标左键拖动
   - 应该看到绿色的选择框随着鼠标移动
   - 松开鼠标

5. **确认选择**：
   - 应该看到两个按钮："✓ 确认选择" 和 "✗ 取消"
   - 顶部应该出现提示："✓ 区域已选择，点击确认或取消"
   - 点击"✓ 确认选择"

### 4. 测试截图功能

1. **再次点击扩展图标**
2. **点击"开始截图"按钮**
   - 应该看到："✓ 滚动截图已开启，滚动页面进行捕获"
   - 页面上选定区域应该有蓝色边框
   - 顶部应该出现："📸 截图模式已开启，滚动页面进行捕获"

3. **滚动页面**：
   - 使用鼠标滚轮或键盘滚动
   - 每次滚动停止后，右上角应该短暂显示："✓ 已捕获 N 张截图"

4. **停止截图**：
   - 点击扩展图标
   - 点击"停止截图"
   - 应该看到："✓ 已捕获 N 张截图"

5. **下载截图**：
   - 点击"下载截图"
   - 应该看到："✓ 截图已开始下载"
   - 浏览器会下载所有截图到下载文件夹

## 常见问题排查

### 问题1：点击"选择区域"没有反应

**可能原因和解决方案：**

1. **Content Script 未加载**
   - 打开 F12 Console
   - 刷新页面
   - 检查是否有 `✓ ScrollSnap content script loaded and ready`

2. **页面不支持扩展**
   - 扩展无法在 `chrome://`、`chrome-extension://`、`edge://` 页面工作
   - 尝试在普通网页（如 https://wikipedia.org）测试

3. **权限问题**
   - 检查 `chrome://extensions/`
   - 确保扩展有"访问网站数据"权限

### 问题2：选择框不显示

**检查步骤：**

1. 打开 F12 Console
2. 查看是否有 JavaScript 错误
3. 检查网页是否使用了很高的 z-index（可能覆盖选择框）
4. 尝试在简单页面测试（如 https://example.com）

### 问题3：截图是空白或黑色

**可能原因：**

1. **网页使用了 Canvas 或 WebGL**
   - 某些动态内容无法截取

2. **隐私保护**
   - 浏览器可能阻止截取某些内容

3. **设备像素比问题**
   - 在不同分辨率屏幕上测试

### 问题4：下载失败

**解决方案：**

1. 检查浏览器下载设置
2. 确保没有禁用自动下载
3. 检查下载文件夹权限

## 查看详细日志

### Content Script 日志

```javascript
// 在页面 Console 中查看这些日志：
ScrollSnap: 启动选择模式
ScrollSnap: 开始捕获
ScrollSnap: 停止捕获，共捕获 X 张
ScrollSnap: 下载 X 张截图
```

### Popup 日志

1. 右键点击扩展图标
2. 选择"检查弹出内容"
3. 查看 Console 标签

### Background Script 日志

1. 访问 `chrome://extensions/`
2. 找到 ScrollSnap
3. 点击"检查视图: service worker"
4. 查看 Console 标签

## 测试页面推荐

这些页面适合测试滚动截图功能：

1. **维基百科**：https://zh.wikipedia.org
   - 长文章，适合测试滚动截图

2. **GitHub**：https://github.com
   - 代码页面，测试固定宽度内容

3. **Example.com**：https://example.com
   - 简单页面，适合基础功能测试

4. **Hacker News**：https://news.ycombinator.com
   - 简洁布局，适合测试区域选择

## 重置扩展状态

如果扩展出现异常：

1. 访问 `chrome://extensions/`
2. 找到 ScrollSnap
3. 点击 **刷新图标** 🔄
4. 刷新测试页面
5. 重新测试功能

## 完全重装扩展

1. 访问 `chrome://extensions/`
2. 点击 ScrollSnap 的"移除"
3. 点击"加载已解压的扩展程序"
4. 重新选择 ScrollSnap 文件夹

## 需要帮助？

如果问题仍然存在：

1. 查看浏览器 Console 中的错误信息
2. 记录复现步骤
3. 在 GitHub 提交 Issue
4. 包含浏览器版本、操作系统、错误截图

---

**祝调试顺利！** 🐛🔧
